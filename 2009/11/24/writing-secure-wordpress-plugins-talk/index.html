<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Writing Secure WordPress Plugins talk by Mark Jaquith | dm&#39;s blog</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Continuing my notes and remarks from WordCamp, I attended Writing Secure Plugins, which was given by Mark Jaquith (@markjaquith on Twitter). I found the talk to be also slightly introductory on securi">
<meta property="og:type" content="article">
<meta property="og:title" content="Writing Secure WordPress Plugins talk by Mark Jaquith">
<meta property="og:url" content="http://damog.net/blog/2009/11/24/writing-secure-wordpress-plugins-talk/index.html">
<meta property="og:site_name" content="dm's blog">
<meta property="og:description" content="Continuing my notes and remarks from WordCamp, I attended Writing Secure Plugins, which was given by Mark Jaquith (@markjaquith on Twitter). I found the talk to be also slightly introductory on securi">
<meta property="og:image" content="http://damog.net/old/stereonaut/2009/11/IMG_30081-300x225.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Writing Secure WordPress Plugins talk by Mark Jaquith">
<meta name="twitter:description" content="Continuing my notes and remarks from WordCamp, I attended Writing Secure Plugins, which was given by Mark Jaquith (@markjaquith on Twitter). I found the talk to be also slightly introductory on securi">
  
    <link rel="alternative" href="/blog/atom.xml" title="dm&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/blog/favicon.png">
  
  <link rel="stylesheet" href="/blog/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/blog/">dm&#39;s blog</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/blog/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/blog/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q" value="site:http://damog.net/blog"></form>
	</div>
</header>
    <div id="main">
      <article id="post-writing-secure-wordpress-plugins-talk" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/blog/2009/11/24/writing-secure-wordpress-plugins-talk/" class="article-date">
  <time datetime="2009-11-24T16:29:18.000Z" itemprop="datePublished">Tue Nov 24, 2009</time>
</a>
		</span>
		<span class="meta-elements author">David Moreno</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 class="article-title entry-title" itemprop="name">
      Writing Secure WordPress Plugins talk by Mark Jaquith
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Continuing my notes and remarks from <a href="http://2009.newyork.wordcamp.org/" target="_blank" rel="external">WordCamp</a>, I attended <a href="http://2009.newyork.wordcamp.org/2009/11/13/writing-secure-plugins/" target="_blank" rel="external">Writing Secure Plugins</a>, which was given by <a href="http://markjaquith.com/" target="_blank" rel="external">Mark Jaquith</a> (@<a href="http://twitter.com/markjaquith" target="_blank" rel="external">markjaquith</a> on Twitter). I found the talk to be also slightly introductory on security matters but nicely oriented to <a href="http://wordpress.org" target="_blank" rel="external">WordPress</a> plugins and general PHP Web app development. I believe most of the tips given should be taken into consideration by every PHP coder out there, not just WP people.</p>
<p style="text-align: center;"><a href="http://damog.net/old/stereonaut/2009/11/IMG_30081.jpg" target="_blank" rel="external"><img class="aligncenter size-medium wp-image-1053" title="IMG_3008" src="http://damog.net/old/stereonaut/2009/11/IMG_30081-300x225.jpg" alt="IMG_3008" width="300" height="225"></a></p><br><p style="text-align: center;"></p>

<p>The talk was split into the different attacks that are common on Web applications and mainly pointing to functions and actions to be taken. Here are my notes:</p>
<p></p><h3>SQL injection</h3><p></p>
<p><ul><br>    <li><a href="http://codex.wordpress.org/Data_Validation" target="_blank" rel="external"><tt>esc_sql()</tt></a>, allows you to escape SQL queries.</li><br>    <li><tt>absint()</tt>, allows to convert an ID value to its positive integer value to prevent ID injection.</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/wpdb_Class#UPDATE_rows" target="_blank" rel="external"><tt>$wpdb-&gt;update()</tt></a>, a WordPress <a href="http://codex.wordpress.org/Plugin_API" target="_blank" rel="external">API</a> method to update data.</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/wpdb_Class#INSERT_rows" target="_blank" rel="external"><tt>$wpdb-&gt;insert()</tt></a>, a WordPress API method to insert new data rows.</li><br>    <li><a href="http://php.net/compact" target="_blank" rel="external"><tt>compact()</tt></a>, PHP core function that lets you use variable names as strings.</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/wpdb_Class#Protect_Queries_Against_SQL_Injection_Attacks" target="_blank" rel="external"><tt>$wpdb-&gt;prepare()</tt></a>, crafts a secure SQL statement with placeholders.</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/wpdb_Class#SELECT_a_Variable" target="_blank" rel="external"><tt>$wpdb-&gt;get_var()</tt></a>, returns a single variable from WordPress data.</li><br></ul></p>
<p></p><h3>Cross-site scripting (XSS)</h3><p></p>
<p><ul><br>    <li>“Everything is suspicious”.</li><br>    <li><tt><a href="http://wpseek.com/esc_attr_e/" target="_blank" rel="external">esc_attr_e</a>()</tt>, escapes a translated string to be used as an HTML tag attribute.</li><br>    <li><a href="http://wpdevel.wordpress.com/tag/esc_html/" target="_blank" rel="external"><tt>esc_html()</tt></a>, escapes general HTML.</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/esc_attr" target="_blank" rel="external"><tt>esc_attr()</tt></a>, escapes a string for tag attribute.</li><br>    <li><a href="http://wordpress.org/support/topic/282964" target="_blank" rel="external"><tt>esc_url()</tt></a>, encodes URL.</li><br>    <li><a href="http://wpseek.com/esc_url_raw/" target="_blank" rel="external"><tt>esc_url_raw()</tt></a>, encodes URL without HTML entities to be encoded.</li><br>    <li><a href="http://wpseek.com/esc_js/" target="_blank" rel="external"><tt>esc_js()</tt></a>, encodes JavaScript code.</li><br></ul></p>
<p></p><h3>Cross-site request forgery (CSRF)</h3><p></p>
<p><ul><br>    <li>Understand the difference between authorization and intention.</li><br>    <li><a href="http://codex.wordpress.org/WordPress_Nonces" target="_blank" rel="external">Nonces</a> (token handling).</li><br>    <li><a href="http://codex.wordpress.org/Function_Reference/wp_nonce_field" target="_blank" rel="external"><tt>wp_nonce_field()</tt></a> and then, <a href="http://wpseek.com/check_admin_referer/" target="_blank" rel="external"><tt>check_admin_referer()</tt></a>.</li><br>    <li>current_user_can(), API capability checking.</li><br></ul></p>
<p></p><h3>AJAX CSRF</h3><p></p>
<p><ul><br>    <li><a href="http://ocaoimh.ie/89494197/make-your-wordpress-plugin-talk-ajax/" target="_blank" rel="external"><tt>&amp;_ajax_nonce</tt> = NONCE</a></li><br></ul></p>
<p></p><h3>Privilege escalation</h3><p></p>
<p></p><h3>Stupid shit!</h3><p></p>
<p><ul><br>    <li>Avoid <a href="http://php.net/exec" target="_blank" rel="external"><tt>exec()</tt></a> at all costs!</li><br>    <li>Use blank or hardcoded paths instead of <tt>$_SERVER[‘REQUEST_URI’]</tt> on form submission.</li><br></ul></p>
<p></p><h3>Presentation</h3><p></p>
<div style="text-align: center;"><object style="margin: 0px;" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="425" height="355" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="allowFullScreen" value="true"><param name="allowScriptAccess" value="always"><param name="src" value="http://static.slidesharecdn.com/swf/ssplayer2.swf?doc=wordpresssecurity-wordcampny-091114224648-phpapp01&amp;rel=0&amp;stripped_title=writing-secure-plugins-wordcamp-new-york-2009"><param name="allowfullscreen" value="true"><embed style="margin: 0px;" type="application/x-shockwave-flash" width="425" height="355" src="http://static.slidesharecdn.com/swf/ssplayer2.swf?doc=wordpresssecurity-wordcampny-091114224648-phpapp01&amp;rel=0&amp;stripped_title=writing-secure-plugins-wordcamp-new-york-2009" allowscriptaccess="always" allowfullscreen="true"></object></div>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/ajax/">ajax</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/csrf/">csrf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/php/">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/plugins/">plugins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/security/">security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/sql-injection/">sql injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/wordcamp/">wordcamp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/wordpress/">wordpress</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/xss/">xss</a></li></ul>

			</span>
		</div>
	</footer>
	
    
<nav id="article-nav">
  
    <a href="/blog/2009/11/29/vitacilina-debian-per/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Vitacilina now in Debian + 0.2 released!
        
      </div>
    </a>
  
  
    <a href="/blog/2009/11/24/linux-org-mx-planeta-linux-mexico/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          linux.org.mx is now Planeta Linux México
        
      </div>
    </a>
  
</nav>

  
</article>




    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:damog.net/blog">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/blog/">dm&#39;s blog</a>
	</h1>
	<span class="copyright">
		&copy; 2016 David Moreno<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js" type="text/javascript"></script>
  </div>
</body>
</html>